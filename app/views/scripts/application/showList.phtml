<script src="https://cdn.tailwindcss.com"></script>
<?php
$data = JsonManager::readJson();
?>

<div class="bg-gray-100 p-4">
    <h2 class="text-xl font-bold mb-4">Task List</h2>
    
    <div class="mb-4">
        <a href="http://localhost/DevOPS/web/taskForm" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            Add a new task
        </a>
    </div>

    <?php if (empty($data)): ?>
        <p class="text-gray-700 text-lg">No tasks created yet.</p>
    <?php else: ?>
        <?php foreach ($data as $taskId => $task): ?>
            <div class="bg-white shadow rounded-lg p-4 mb-4 flex items-center justify-between">
                <div>
                    <h3 class="text-lg font-bold mb-2"><?= $task['name'] ?></h3>
                    <p class="text-gray-700"><?= $task['description'] ?></p>
                    <p class="text-gray-500 mt-2">
                        Author: <?= $task['author'] ?> | Status: <?= $task['status'] ?>
                    </p>
                    <p class="text-gray-500">
                        Start date: <?= $task['startDate'] ?>
                    </p>
                    <?php if (isset($task['endDate'])): ?>
                        <p class="text-gray-500">
                            End date: <?= $task['endDate'] ?>
                        </p>
                    <?php endif; ?>
                </div>
                <div class="space-x-2">
                <a href="http://localhost/DevOPS/web/viewTask?taskId=<?= $taskId ?>" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                        View
                    </a>

                    <a href="http://localhost/DevOPS/web/edit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                        Update
                    </a>
                    <button onclick="confirmDelete(<?= $taskId ?>)" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                        Delete
                    </button>
                </div>
            </div>
        <?php endforeach; ?>
    <?php endif; ?>
</div>

<script>
    function confirmDelete(taskId) {
        if (confirm("Are you sure you want to delete this task?")) {
            window.location.href = "http://localhost/DevOPS/web/deleted";
        }
    }
</script>
